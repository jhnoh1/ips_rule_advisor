<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../static/vars/vars.css">
  <link rel="stylesheet" href="../static/styles/finalreport.css">
  
  
  <style>
   a,
   button,
   input,
   select,
   h1,
   h2,
   h3,
   h4,
   h5,
   * {
       box-sizing: border-box;
       margin: 0;
       padding: 0;
       border: none;
       text-decoration: none;
       background: none;
   
       -webkit-font-smoothing: antialiased;
   }
   
   menu, ol, ul {
       list-style-type: none;
       margin: 0;
       padding: 0;
   }
   </style>
  <title>IPS Rule Advisor</title>
</head>
<body>
  <div class="layout-wrapper">
    <header class="header">
      <div class="header-logo">
        <div class="logo">
          <img class="hdd-fill" src="../static/vectors/logo-hdd-fill0.svg" />
          <img class="shield-plus" src="../static/vectors/logo-shield-plus0.svg" />
        </div>
      </div>
      <div class="header-nav">
        <a class="nav-item--active item-text" href="./getinfo_search.html">정보수집</a>
        <a class="nav-item item-text" href="./ruletest.html">룰 테스트</a>
        <a class="nav-item item-text" href="">마이페이지</a>
      </div>
      <div class="header-auth">
        <div class="auth-profile">
          <div class="avatar-img">
            <img class="shape" src="../static/images/avatar-0.png"/>
          </div>
          <div class="profile-name">
            <div class="text-name">YSD 님</div>
          </div>
        </div>
      </div>
    </header>
    <div class="main-container">
      <div class="card-cve-info">
        <div class="card__title">CVE-2024-12345</div>
        <div class="line-seperate"></div>
        <div class="card__text">게시일 : 2022-03-03 | 최종 수정일 : 2023-04-20</div>
        <div class="card__text">취약점 유형 : 버퍼 오버플로우</div>
        <div class="card__text">
          이 취약점을 이용하면 공격자가 XYZ 구성 요소의 버퍼 오버플로우를 악용하여
          대상 시스템에서 임의의 코드를 실행할 수 있습니다.
        </div>
        <div class="accodion-container">
          <div class="accordion-title">
            <div class="text-accodion-title">CVE 정보 수집 결과 자세히 보기</div>
            <img class="btn-accodion" src="../static/vectors/btn-accodion-up.svg" />
          </div>
          <div class="accodion-content">
            <div class="text-accodion-content-subtitle">영향받는 제품</div>
            <div class="table">
              <div class="table-header">
                <div class="table-grid-03">
                  <div class="table__cell-03 text-cell">공급업체</div>
                  <div class="table__cell-03 text-cell">제품</div>
                  <div class="table__cell-03 text-cell">버전</div>
                </div>
              </div>
              <div class="table-row">
                <div class="table-grid-03">
                  <div class="table__cell-03 text-cell">abc</div>
                  <div class="table__cell-03 text-cell">qwe</div>
                  <div class="table__cell-03 text-cell">1.2.3</div>
                </div>
              </div>
              <div class="table-row">
                <div class="table-grid-03">
                  <div class="table__cell-03 text-cell">xyz</div>
                  <div class="table__cell-03 text-cell">asd</div>
                  <div class="table__cell-03 text-cell">4.5.0</div>
                </div>
              </div>
            </div>
            <div class="line-bar"></div>
            <div class="table">
              <div class="table-header">
                <div class="table-grid-01">
                  <div class="table__cell-01 text-cell">CPE</div>
                </div>
              </div>
              <div class="table-row">
                <div class="table-grid-01">
                  <div class="table__cell-01 text-cell">cpe:/a:abc:xyz:3.4.1</div>
                </div>
              </div>
              <div class="table-row">
                <div class="table-grid-01">
                  <div class="table__cell-01 text-cell">cpe:/a:abc:xyz:3.4.1</div>
                </div>
              </div>
            </div>
            <div class="text-accodion-content-subtitle">CVSS</div>
            <div class="tab-container">
              <div class="tab-item--unselected text-tab--unselected">CVSS 2.0</div>
              <div class="tab-item--selected text-tab--selected">CVSS 3.x</div>
              <div class="tab-item--unselected text-tab--unselected">CVSS 4.0</div>
            </div>
            <div class="table">
              <div class="table-header">
                <div class="table-grid-03">
                  <div class="table__cell-03 text-cell">기본 점수</div>
                  <div class="table__cell-03 text-cell">악용 가능성 점수</div>
                  <div class="table__cell-03 text-cell">영향 점수</div>
                </div>
              </div>
              <div class="table-row">
                <div class="table-grid-03">
                  <div class="table__cell-03 text-cell">8.1</div>
                  <div class="table__cell-03 text-cell">3.9</div>
                  <div class="table__cell-03 text-cell">5.9</div>
                </div>
              </div>
            </div>
            <div class="text-accodion-content-subtitle">매트릭 요약</div>
            <div class="text-accodion">
              이 취약점은 네트워크를 통해 원격으로 악용될 수 있으며, 공격 복잡성이
              낮고 특별한 권한이 필요하지 않습니다. 그러나 공격자는 사용자가 특정
              작업을 수행하도록 속일 필요가 있습니다. 이 취약점은 공격자가 다른
              시스템이나 구성 요소에 영향을 미치지 못하게 합니다. 영향 측면에서 이
              취약점은 민감한 정보 공개, 데이터 수정 또는 손상, 서비스 거부 또는
              시스템 가용성 저하를 초래할 수 있습니다.
            </div>
          </div>
        </div>
      </div>
      <div class="card-rule-result">
        <div class="card__title">테스트 결과</div>
        <div class="line-seperate"></div>
        <div class="card__subtitle">테스트 IPS 룰</div>
        <div class="card__rulebox">
          <div class="text-rulebox">
            alert tcp any any -&gt; any 80 (msg:&quot;SQL injection&quot;;
            content:&quot;SELECT&quot;; sid:1000001; rev:1;)
          </div>
        </div>
        <div class="accodion-container">
          <div class="accordion-title">
            <div class="text-accodion-title">IPS 룰 테스트 결과 자세히 보기</div>
            <img class="btn-accodion" src="../static/vectors/btn-accodion-up.svg" />
          </div>
          <div class="accodion-content">
            <div class="text-accodion-content-subtitle">테스트 환경</div>
            <div class="table">
              <div class="table-header">
                <div class="table-grid-03">
                  <div class="table__cell-03 text-cell">테스트 환경</div>
                  <div class="table__cell-03 text-cell">총 테스트 패킷</div>
                  <div class="table__cell-03 text-cell">공격 패킷</div>
                  <div class="table__cell-03 text-cell">정상 패킷</div>
                </div>
              </div>
              <div class="table-row">
                <div class="table-grid-03">
                  <div class="table__cell-03 text-cell">Snort v1.3.0</div>
                  <div class="table__cell-03 text-cell">10,000</div>
                  <div class="table__cell-03 text-cell">2,500</div>
                  <div class="table__cell-03 text-cell">7,500</div>
                </div>
              </div>
            </div>
            <div class="text-accodion-content-subtitle">정확도 테스트 결과</div>
            <div class="table">
              <div class="table-header-hug">
                <div class="table-grid-03">
                  <div class="table__cell-03 text-cell">정확도 비율</div>
                  <div class="table__cell-03 text-cell">오탐 패킷(률)<br/>(False Positive)</div>
                  <div class="table__cell-03 text-cell">미탐 패킷(률)<br/>(False Negative)</div>
                  <div class="table__cell-03 text-cell">정탐 패킷(률)<br/>(True Positive)</div>
                  <div class="table__cell-03 text-cell">정탐 패킷(률)<br/>(True Negative)</div>
                </div>
              </div>
              <div class="table-row">
                <div class="table-grid-03">
                  <div class="table__cell-03 text-cell">80%</div>
                  <div class="table__cell-03 text-cell">500(20%)</div>
                  <div class="table__cell-03 text-cell">1,500(20%)</div>
                  <div class="table__cell-03 text-cell">2,000(80%)</div>
                  <div class="table__cell-03 text-cell">6,000(80%)</div>
                </div>
              </div>
            </div>
            <div class="text-accodion-content-subtitle">성능 테스트 결과</div>
            <div class="table">
              <div class="table-header">
                <div class="table-grid-03">
                  <div class="table__cell-03 text-cell">지연 시간</div>
                  <div class="table__cell-03 text-cell">CPU 사용량</div>
                  <div class="table__cell-03 text-cell">메모리 사용량</div>
                </div>
              </div>
              <div class="table-row">
                <div class="table-grid-03">
                  <div class="table__cell-03 text-cell">5ms</div>
                  <div class="table__cell-03 text-cell">15%</div>
                  <div class="table__cell-03 text-cell">2,024MB</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="card-comment">
        <div class="card__title">유저 의견</div>
        <div class="line-seperate"></div>
        <div class="comment-area">
          <div class="comment-block">
            <div class="avatar-img">
              <img class="img" src="../static/images/avatar-0.png" />
            </div>
            <div class="comment-block-right">
              <div class="comment-info">
                <div class="text-comment-name">Jane Smith</div>
                <div class="text-comment-time">2024/05/30 05:33 PM</div>
              </div>
              <div class="text-comment-text">
                이 취약점은 즉시 해결해야 할 심각한 문제입니다. 테스트 결과가 좋아
                보이지만 완화 전략에 대한 더 자세한 내용을 보고 싶습니다.
              </div>
            </div>
          </div>
          <div class="comment-block">
            <div class="avatar-initial">
              <div class="initials">B</div>
            </div>
            <div class="comment-block-right">
              <div class="comment-info">
                <div class="text-comment-name">Bob Johnson</div>
                <div class="text-comment-time">2024/05/30 05:35 PM</div>
              </div>
              <div class="text-comment-text">
                테스트 결과가 높은 진짜 양성률을 보여 주어 기쁩니다. 이를 통해
                솔루션의 효과성에 대한 확신을 얻었습니다. 다음 단계를 기대하고
                있습니다.
              </div>
            </div>
          </div>
          <div class="comment-block">
            <div class="avatar-img">
              <img class="img" src="../static/images/avatar-1.png" />
            </div>
            <div class="comment-block-right">
              <div class="comment-info">
                <div class="text-comment-name">John Doe</div>
                <div class="text-comment-time">2024/05/30 05:37 PM</div>
              </div>
              <div class="text-comment-text">
                제공된 정보가 매우 유용하지만 CVSS 벡터와 그 계산 방식에 대한 더
                자세한 내용을 보고 싶습니다. 이를 통해 취약점의 심각도를 better
                이해할 수 있을 것 같습니다.
              </div>
            </div>
          </div>
        </div>
        <div class="textarea-field">
          <input class="textarea" placeholder="의견 추가..." ></input>
        </div>
        <button class="button-primary text-button--primary">의견 남기기</button>
      </div>
    </div>
  </div>
  <script>
    
    document.addEventListener('DOMContentLoaded', async () => {
  try {
    // URL에서 testid를 추출
    const urlParams = new URLSearchParams(window.location.search);
    const testid = urlParams.get('testid'); // URL 쿼리에서 testid 값을 가져옴

    if (!testid) {
      console.error('testid가 URL에 없습니다.');
      return;
    }

    // 서버에서 데이터를 fetch
    const response = await fetch('/rule/test/show', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ testid: testid }) // 필요한 testid를 여기에 넣음
    });

    const data = await response.json();

    document.getElementById('rule-test-button').addEventListener('click', () => {
      const cveId = data.cve
      const envi = data.envi
      if (cveId !== 'N/A') {
        window.location.href = `/ruletest?cve=${encodeURIComponent(cveId)}&envi=${encodeURIComponent(envi)}`;
      } else {
        alert('CVE ID를 로드할 수 없습니다.');
      }
    });

    // 데이터를 HTML에 렌더링
    document.getElementById('cve-id').textContent = data.cve || 'N/A';
    document.getElementById('publish-date').textContent = `게시일: ${data.created_at || 'N/A'}`;
    document.getElementById('vuln-type').textContent = `취약점 유형: ${data.vuln_type || 'N/A'}`;
    document.getElementById('description').textContent = data.description || 'N/A';
    document.getElementById('test-rule').textContent = data.rule || 'N/A';
    document.getElementById('test-environment').textContent = data.setting || 'N/A';
    document.getElementById('total-packets').textContent = data.total || 'N/A';
    document.getElementById('attack-packets').textContent = data.attacknum || 'N/A';
    document.getElementById('normal-packets').textContent = data.normalnum || 'N/A';
    document.getElementById('accuracy-rate').textContent = data.accuracyrate || 'N/A';
    document.getElementById('false-positive').textContent = data.attackrate || 'N/A';
    document.getElementById('false-negative').textContent = data.normalrate || 'N/A';
    document.getElementById('true-positive').textContent = data.attacktrue || 'N/A';
    document.getElementById('true-negative').textContent = data.normaltrue || 'N/A';
    document.getElementById('latency').textContent = data.attacklatency || 'N/A';
    document.getElementById('cpu-usage').textContent = data.cpu_usage || 'N/A';
    document.getElementById('memory-usage').textContent = data.memory_usage || 'N/A';

  } catch (error) {
    console.error('Error fetching data:', error);
  }
});
  </script>

</body>
</html>